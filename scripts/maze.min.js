const DEFAULT_HEX_SIZE=25,SQRT_3=Math.sqrt(3);var Directions=Object.freeze(["SOUTHEAST","SOUTH","SOUTHWEST","NORTHWEST","NORTH","NORTHEAST"]),Masks=Object.freeze({VISITED:1,CURSOR:2,PATH_SOUTHEAST:4,PATH_SOUTH:8,PATH_SOUTHWEST:16,PATH_NORTHWEST:32,PATH_NORTH:64,PATH_NORTHEAST:128}),ReverseDirectionMasks=Object.freeze({PATH_SOUTHEAST:Masks.PATH_NORTHWEST,PATH_SOUTH:Masks.PATH_NORTH,PATH_SOUTHWEST:Masks.PATH_NORTHEAST,PATH_NORTHWEST:Masks.PATH_SOUTHEAST,PATH_NORTH:Masks.PATH_SOUTH,PATH_NORTHEAST:Masks.PATH_SOUTHWEST}),Neighbors=Object.freeze({SOUTHEAST:[1,0],SOUTH:[0,1],SOUTHWEST:[-1,1],NORTHWEST:[-1,0],NORTH:[0,-1],NORTHEAST:[1,-1]});function getDefaultLineWidth(e){return Math.ceil(e/4)}function getRandomInt(e){return Math.floor(Math.random()*Math.floor(e))}function getNeighborIndex(e,t,r,n,o){var i=qrToIndex(...indexToQRCoords(e,t).map((e,t)=>e+Neighbors[o][t]));return!(i.some(e=>e<0)||i[0]>=r||i[1]>=n)&&i}function indexToQRCoords(e,t){return[e,t-Math.floor(e/2)]}function indexToXY(e,t,r){return qrToXY(...indexToQRCoords(e,t),r)}function qrToIndex(e,t){return[e,t+Math.floor(e/2)]}function qrToXY(e,t,r){return[3*e/2,e*SQRT_3/2+t*SQRT_3].map((e,t)=>(e+[1.5,SQRT_3/2+.1][t])*(r||DEFAULT_HEX_SIZE))}function getHexCorner(e,t,r,n){return[e+r*Math.cos(n*Math.PI/3),t+r*Math.sin(n*Math.PI/3)]}function drawHexFromArray(e,t,r,n,o){var i,T,a,s=o||DEFAULT_HEX_SIZE;for([i,T]=qrToXY(...indexToQRCoords(r,n),s),e.beginPath(),e.moveTo(...getHexCorner(i,T,s,0)),a=1;a<=6;a++)t[r][n]&Masks["PATH_"+Directions[a-1]]?e.moveTo(...getHexCorner(i,T,s,a)):e.lineTo(...getHexCorner(i,T,s,a));e.strokeStyle=t[r][n]&Masks.VISITED?"#FFFFFF":"#EE00EE",e.lineWidth=getDefaultLineWidth(s),e.stroke(),t[r][n]&Masks.CURSOR?(e.fillStyle="#00FF00",e.fillRect(i-.25*s,T-.25*s,s/2,s/2)):e.clearRect(i-.26*s,T-.26*s,.52*s,.52*s)}function Maze(e,t,r,n,o){"use strict";if(!e||!e.getContext)throw"Could not initialize Game. Argument must be a valid canvas element.";var i,T=30,a=e,s=o,H=a.getContext("2d"),S=(n=n||DEFAULT_HEX_SIZE,[[0,0]]),c=[...Array(t||10)].map(e=>new Uint8Array(r||10).fill(0)),f=!1,h=Date.now(),A=function(e){if(!S.length)return!1;var n,o,i,T,a,s=!1!==e,H=[];for([n,o]=S[S.length-1],s&&u(n,o),c[n][o]|=Masks.VISITED|Masks.CURSOR,i=0;i<Directions.length;i++)!(a=getNeighborIndex(n,o,t,r,Directions[i]))||c[a[0]][a[1]]&Masks.VISITED||H.push([Directions[i],a]);return H.length?([T,i]=H[getRandomInt(H.length)],c[n][o]|=Masks["PATH_"+T],c[i[0]][i[1]]|=ReverseDirectionMasks["PATH_"+T],S.push(i)):S.pop(),s&&E(n,o),c[n][o]^=Masks.CURSOR,!0},u=function(e,t){var r,o;[r,o]=indexToXY(e,t,n),H.clearRect(r-1.5*n,o-SQRT_3*n,3*n,2*SQRT_3*n)},l=function(){H.clearRect(0,0,a.width,a.height)},E=function(e,o){var i,T;[i,T]=indexToXY(e,o,n),drawHexFromArray(H,c,e,o,n),Directions.map(n=>getNeighborIndex(e,o,t,r,n)).filter((e,t)=>!!e).forEach(e=>{drawHexFromArray(H,c,...e,n)})},R=function(e){var t,r;if(!s||e)for(t=0;t<c.length;t++)for(r=0;r<c[t].length;r++)drawHexFromArray(H,c,t,r,n)},O=function(){var e=Date.now(),t=e-h,r=!0;t>1e3/T&&(h=e-t%(1e3/T),r=A()),r&&f?i=requestAnimationFrame(O):f=!1};this.startGame=function(){f||(R(),i=requestAnimationFrame(O),f=!0)},this.stopGame=function(){f&&(cancelAnimationFrame(i),f=!1)},this.resetGame=function(){f&&this.stopGame(),l(),S=[[0,0]],c=[...Array(t||10)].map(e=>new Uint8Array(r||10).fill(0)),R()},this.renderMaze=function(e){e&&this.resetGame(),l(),H.fillStyle="#FFCCFF",H.font="40px san-serif";var t="Generating Maze, Please Wait...",r=H.measureText(t).width,n=H.measureText("M").width;H.fillText(t,a.width/2-r/2,a.height/2-n/2),setTimeout(()=>{for(;A(!1););l(),R(!0)},100)},this.clear=function(){l()},this.setHollow=function(e){s=e},this.setPerSecond=function(e){T=e||30},l(),R()}